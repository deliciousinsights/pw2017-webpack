<!doctype html>
<html lang="fr">

<head>
  <meta charset="utf-8">

  <title>Webpack comme des grand·e·s ! • Christophe Porteneuve @ Paris Web 2017</title>

  <meta name="description" content="Un atelier de 3h pour bien prendre en main Webpack à partir de zéro.">
  <meta name="author" content="Christophe Porteneuve">

  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

  <link href='css/fonts.css' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="css/reveal.css">
  <link rel="stylesheet" href="css/animate.min.css">
  <link rel="stylesheet" href="css/theme/sky.css" id="theme-basis">
  <link rel="stylesheet" href="css/theme/pw15.css" id="theme">

  <!-- Code syntax highlighting -->
  <link rel="stylesheet" href="lib/css/prism.css">

  <!-- If the query includes 'print-pdf', include the PDF print sheet -->
  <script>
    if (window.location.search.match(/print-pdf/gi)) {
      var link = document.createElement('link')
      link.rel = 'stylesheet'
      link.type = 'text/css'
      link.href = 'css/print/pdf.css'
      document.getElementsByTagName('head')[0].appendChild(link)
    }
  </script>

  <!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
  <script>
    (function (i, s, o, g, r, a, m) {
      i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
        (i[r].q = i[r].q || []).push(arguments)
      }, i[r].l = 1 * new Date(); a = s.createElement(o),
        m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
    })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

    ga('create', 'UA-43650325-21', 'auto');
    ga('send', 'pageview');
  </script>
</head>

<body id="prioFix">

  <div class="reveal">

    <!-- Any section element inside of this container is displayed as a slide -->
    <div class="slides">
      <section id="mainTitle">
        <h1>
          Webpack
          <span>comme des grand·e·s !</span>
        </h1>
        <p>
          <small>Un atelier de
            <a href="http://tddsworld.com/">Christophe Porteneuve</a> at
            <a href="https://www.paris-web.fr/">Paris Web 2017</a>
          </small>
        </p>
      </section>

      <section id="whoami">
        <h2>whoami</h2>

        <pre><code data-trim class="language-js">
const christophe = {
  family: { wife: 'Élodie', son: 'Maxence' },
  city: 'Paris, FR',
  company: 'Delicious Insights',
  trainings: [
    'Web Apps Modernes', 'Node.js', 'Git Total',
    'ES Total', 'Webpack'
  ],
  webSince: 1995,
  claimsToFame: [
    'Prototype.js',
    'Ruby On Rails',
    'Prototype and Script.aculo.us',
    'Paris Web',
    'NodeSchool Paris'
  ],
}
          </code></pre>
      </section>

      <section data-state="theme-color-blue-yellow">
        <section id="basics">
          <h3>Rappelons</h3>
          <h1>les bases</h1>
        </section>

        <section>
          <h2>Bundlers vs. Task Runners</h2>

          <p>
            Webpack est un
            <em>bundler</em>, pas un
            <em>task runner</em>
            <br/> (De ce point de vue, il se rapproche de Brunch et Broccoli)
          </p>
          <p>Intérêt : moins de config, plus d’optimisations possibles</p>
        </section>

        <section>
          <h2>Points forts particuliers</h2>

          <p>Vitesse</p>
          <p>Hot Module Replacement (HMR)</p>
          <p>Approche graphe (on y vient)</p>
          <p>
            Richesse d’optimisations proposées
            <br/> (en particulier autour du
            <em>bundle splitting</em> et
            <em>code splitting</em>)
          </p>
        </section>

        <section>
          <h2>Le graphe de dépendances</h2>

          <p>
            <img src="./images/webpack-dep-graph.png" alt="Diagramme illustratif d’un graphe de dépendances Webpack" />
          </p>
        </section>

        <section>
          <h2>Ce qu’on ne verra pas</h2>

          <p>L’intégration du serveur de dev aux nôtres</p>
          <p>Les finesses de gestion du HMR</p>
          <p>Les parallélisations et mises en cache</p>
          <p>L’externalisation et les cibles alternatives de build</p>
          <p>Le
            <em>code splitting</em>
          </p>
          <p>Les passerelles avec React (notamment React-Router et Redux)</p>
          <p>Les loaders et plugins personnalisés</p>
          <p>…</p>
        </section>
      </section>
      <!-- #basics -->

      <section data-state="theme-color-silver-green">
        <section id="first-bundle">
          <h1>Mon premier bundle</h1>
        </section>

        <section>
          <h2>Récupérer le support</h2>

          <pre class="command-line" data-prompt="$" data-output="2,4"><code class="language-bash" data-trim>
node -v
8.6.0
npm -v
5.4.2
git clone https://github.com/deliciousinsights/pw2017-webpack
cd pw2017-webpack
npm install
          </code></pre>

          <p>
            <a href="https://github.com/deliciousinsights/pw2017-webpack#readme" target="_blank">deliciousinsights/pw2017-webpack</a>
          </p>
        </section>

        <section>
          <h2>Le fichier de configuration</h2>

          <p>Juste un module CommonJS</p>
          <p>On est donc libres de construire l’objet exporté comme on veut !</p>
          <p>Peut donc être hyper dynamique, réactif à l’environnement, etc.</p>
          <p>A minima :</p>

          <pre><code class="language-js" data-trim>
module.exports = {
  entry: …,        // Chemin(s) absolu(s) de « module »
  output: {
    path: '…',     // Chemin absolu du dossier destinataire
    filename: '…',
  }
}
          </code></pre>
        </section>

        <section>
          <h2>Premier bundling</h2>

          <p>On se pond deux fichiers sources, une mini-config, et on scripte…</p>
          <p>Y’a quoi exactement dans le bundle ?</p>
        </section>

        <section>
          <h2>Modifs et watch</h2>

          <p>Quand Webpack se soucie-t-il de mes nouveaux fichiers ?</p>
          <p>Le watcher simple dans un premier temps</p>
        </section>
      </section>
      <!-- #first-bundle -->

      <section data-state="theme-color-forest-yellow">
        <section id="dev-server">
          <h2>webpack-dev-server</h2>
        </section>

        <section>
          <h2>À quoi ça sert ?</h2>

          <p>À plein de trucs :</p>
          <p>
            Surveiller les fichiers et déclencher des
            <em>rebuilds</em>
            <br/> (attention à la sauvegarde automatique dans votre EDI/éditeur)
          </p>
          <p>Fournir un service HTTP par-dessus nos builds</p>
          <p>Builder en mémoire pour aller plus vite, garder en cache au passage</p>
          <p>Faire du rafraîchissement automatique</p>
          <p>Permettre d’aller plus loin avec le
            <em>Hot Module Replacement</em>
          </p>
        </section>

        <section>
          <h2>C’est parti</h2>

          <p>Installation</p>
          <p>Lancement</p>
          <p>Le rafraîchissement basique</p>
          <p>Ne rien louper avec l’overlay</p>
        </section>

        <section>
          <h2>Hot Module Replacement</h2>

          <p>Principes</p>
          <p>Mise en place côté Webpack</p>
          <p>Activation côté client</p>
          <p>Mieux voir quels modules sont renvoyés</p>
          <p>Que renvoie-t-on quand ?</p>
        </section>
      </section>
      <!-- #dev-server -->

      <section data-state="theme-color-blue-yellow">
        <section id="styles">
          <h1>Ajouter des styles</h1>
        </section>

        <section>
          <h2>Commençons simplement</h2>

          <pre class="command-line" data-prompt="$"><code class="language-bash" data-trim>
git reset --hard debut-etape-3
npm install
          </code></pre>

          <p>Des CSS « nues »</p>
          <p>Qu’est-ce qu’un loader ?</p>
          <p>style-loader vs. css-loader</p>
          <p>Constater le résultat</p>
        </section>

        <section>
          <h2>SASS, Stylus, etc.</h2>

          <p>Juste un loader en plus…</p>
        </section>

        <section>
          <h2>PostCSS et Autoprefixer</h2>

          <p>Principes</p>
          <p>Configurer Autoprefixer comme plugin</p>
          <p>Browserlist</p>
          <p>Définir nos exigences de compatibilité</p>
          <p>Exemple avec
            <code>display: flex</code>
          </p>
          <p>css-loader et
            <code>importLoaders</code>
          </p>
        </section>

        <section>
          <h2>Source maps pour les styles</h2>

          <p>Le réglage global</p>
          <p>La nécessité de drapeaux
            <em>par loader</em> de style…</p>
        </section>
      </section>
      <!-- #styles -->

      <section data-state="theme-color-silver-green">
        <section id="modularize">
          <h1>Modulariser</h1>
          <h3>la configuration</h3>
        </section>

        <section>
          <h2>Ça devient le bordel…</h2>

          <p>Ça commence à pas mal grandir…</p>
          <p>Si ça continue on va se croire dans Gulp !</p>
          <p>En plus y'a la question de la bascule de mode développement / production</p>
          <p>Comment s’y retrouver ?</p>
          <p>Comment éviter le copier-coller bête d’un projet à l’autre ?</p>
        </section>

        <section>
          <h2>webpack-merge</h2>

          <pre><code class="language-bash">npm install --save-dev webpack-merge</code></pre>

          <p>La difficulté de base : extraire les multiples impacts d’une configuration précise (ex. HMR, extraction CSS…)</p>
          <p>Le module permet d’exprimer des ensembles de fragments de configuration, injectables à l’envi.</p>
          <p>Je vous déroule le
            <em>refactoring</em> de découpe…</p>
        </section>

        <section>
          <h2>Environnements</h2>

          <p>Exporter une fonction</p>
          <p>Le drapeau
            <code>--env</code>
          </p>
          <p>Factoriser nos configurations de développement vs. production</p>
        </section>

        <section>
          <h2>Extraire les fichiers CSS pour la livraison</h2>

          <p>extract-text-webpack-plugin</p>
          <p>Deux parties : l’extracteur et les appels à l’extraction</p>
          <p>Ajustement de notre configuration de production</p>

          <pre><code class="language-bash">git reset --hard etape-4</code></pre>
        </section>
      </section>
      <!-- #modularize -->

      <section data-state="theme-color-forest-yellow">
        <section id="images">
          <h1>Ajouter des images</h1>
        </section>

        <section>
          <h2>file-loader et url-loader</h2>

          <pre><code class="language-bash" data-trim>
git reset --hard debut-etape-5
npm install
          </code></pre>

          <p>Que fait le premier ?</p>
          <p>Pourquoi préférer le second ?</p>
          <p>Configuration avec une limite utile</p>
          <p>Examiner la différence</p>
          <p>Et pour le build de production ?</p>
        </section>

        <section>
          <h2>Et les images dans les styles ?</h2>

          <p>On examine toutes les syntaxes
            <code>url(…)</code>
          </p>
          <p>Super pratique !</p>
          <p>On peut même aller chercher la même fonctionnalité pour les sources d’images dans HTML, JSX…</p>
        </section>
      </section>
      <!-- #images -->

      <section data-state="theme-color-blue-yellow">
        <section id="babel">
          <h1>Utiliser Babel</h1>
        </section>

        <section>
          <h2>Le loader</h2>

          <p>Ajout et configuration</p>
          <p>Presets</p>
          <p>Le preset
            <code>env</code>
          </p>
          <p>Peut-on réutiliser
            <code>.browserslistrc</code> ?</p>
        </section>

        <section>
          <h2>Tree shaking ?</h2>

          <p>Intérêt et limites actuelles</p>
          <p>Exemple avec divers imports de lodash</p>
          <p>Passer en syntaxe modules… mais pas partout ?</p>
          <p>Impact sur le rebuild</p>
        </section>
      </section>
      <!-- #babel -->

      <section data-state="theme-color-silver-green">
        <section id="minify">
          <h1>Minifier</h1>
        </section>

        <section>
          <h2>Minifier JS</h2>

          <p>UglifyJS, sa vie, son œuvre</p>
          <p>Babili ? Un autre ?</p>
          <p>Activer les source maps quand même…</p>
          <p>Environnements et code mort en production</p>
        </section>

        <section>
          <h2>Minifier CSS</h2>

          <p>cssnano est déjà utilisable</p>
          <p>Avec un peu de config : clean-css, etc.</p>
          <p>Comment activer la minification intégrée aux loaders ?</p>
        </section>

        <section>
          <h2>Optimiser les images ?</h2>

          <p>On ne va pas s’y amuser, mais y’a plein d’options, par exemple :</p>
          <p>
            <a href="https://www.npmjs.com/package/image-webpack-loader">image-webpack-loader</a>
          </p>
          <p>
            <a href="https://www.npmjs.com/package/imagemin-webpack-plugin">imagemin-webpack-plugin</a>
          </p>
          <p>
            <a href="https://www.npmjs.com/package/webpack-spritesmith">webpack-spritesmith</a>
          </p>
          <p>…</p>
        </section>
      </section>
      <!-- #minify -->

      <section data-state="theme-color-forest-yellow">
        <section id="cache">
          <h3>Améliorer la</h3>
          <h1>cachabilité</h1>
        </section>

        <section>
          <h2>Vendoring automatique</h2>

          <p>C’est quoi, « vendorer » ?</p>
          <p>CommonsChunkPlugin</p>
          <p>Principes de fonctionnement</p>
          <p>Mise en œuvre dans notre projet</p>
        </section>

        <section>
          <h2>Hashes intelligents</h2>

          <p>Pourquoi mettre des hashes dans les noms de fichiers ?</p>
          <p>
            <code>hash</code>,
            <code>chunkhash</code> et
            <code>contenthash</code>
          </p>
          <p>Limitation de la taille de hash utilisée</p>
          <p>Mise en œuvre</p>
          <p>Soucis avec les noms qui changent tout le temps…</p>
          <p>html-webpack-plugin</p>
          <p>clean-webpack-plugin</p>
          <p>Extraction futée du manifeste pour des mises à jour ciblées</p>
        </section>
      </section>
      <!-- #cache -->

      <section>
        <h2>En savoir (beaucoup) plus</h2>

        <p>
          <a href="https://delicious-insights.com/fr/formations/webpack/">Notre formation Webpack !</a>
        </p>
        <p>
          <a href="https://webpack.js.org/">Les docs officielles</a>
        </p>
        <p>
          <a href="https://survivejs.com/webpack/">SurviveJS</a>
        </p>
        <p>
          <a href="https://www.udemy.com/webpack-2-the-complete-developers-guide/">Le cours sur Udemy</a>
        </p>
      </section>

      <section>
        <h1>Merci !</h1>
        <h3>Et que Webpack soit avec vous.</h3>
        <br>
        <p>Christophe Porteneuve</p>
        <p>
          <a href="https://twitter.com/porteneuve">@porteneuve</a>
        </p>

        <p class="breathing">
          Les slides sont sur
          <a href="http://bit.ly/pw-webpack">bit.ly/pw-webpack</a>
          <br/>
        </p>
      </section>

    </div>
  </div>

  <script src="lib/js/head.min.js"></script>
  <script src="plugin/highlight/prism.js"></script>
  <script src="js/reveal.js"></script>

  <script>
    // Full list of configuration options available here: // https://github.com/hakimel/reveal.js#configuration
    /* global Reveal */
    Reveal.initialize({
      controls: true,
      progress: true,
      history: true,
      center: true,

      width: '95%',
      height: '90%',

      theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
      transition: Reveal.getQueryHash().transition || 'linear', // default/cube/page/concave/zoom/linear/fade/none

      // Parallax scrolling
      // parallaxBackgroundImage: 'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg',
      // parallaxBackgroundSize: '2100px 900px',

      // Optional libraries used to extend on reveal.js
      dependencies: [
        { src: 'lib/js/classList.js', condition: function () { return !document.body.classList } },
        { src: 'plugin/markdown/marked.js', condition: function () { return !!document.querySelector('[data-markdown]') } },
        { src: 'plugin/markdown/markdown.js', condition: function () { return !!document.querySelector('[data-markdown]') } },
        { src: 'plugin/zoom-js/zoom.js', async: true, condition: function () { return !!document.body.classList } },
        { src: 'plugin/notes/notes.js', async: true, condition: function () { return !!document.body.classList } }
      ]
    })
  </script>

</body>

</html>
